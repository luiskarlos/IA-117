(function(){var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};!function(widgetFactory){"function"==typeof define&&define.amd?define("codeshell",["jquery","underscore","codemirror/lib/codemirror","select2","json2","jstorage","jstree"],function($,_,cm){widgetFactory(window.jQuery,window,_,cm)}):widgetFactory(window.jQuery,window,window._,window.CodeMirror)}(function($,window,_,CodeMirror){return $.widget("hr.codeshell",{options:{},_options:{showFileTree:!1,adminView:!1,enableIntellisense:!1,showSave:!1,showCustomInput:!0,showExecute:!1,showCompileTest:!0,compilePrimary:!1,showSubmit:!1,submitPrimary:!0,showUploadCode:!1,uploadCodeText:"Upload Code as File",showDownloadCode:!1,downloadCodeText:"Download Code as File",showNotification:!1,notificationMessage:"",showFullScreen:!1,layout:0,statusText:"",showTheme:!1,showMode:!0,showHeader:!0,showNonEditableHeadTail:!1,enableVersioning:!1,versionIds:[],versioningRestUrl:"",foldCode:!1,enableLanguageChangeHook:!1,dynamicMode:!1,focusLogged:!1,customSetting:null,customToolBar:null,languages:["c","cpp","java","csharp","haskell","php","python","perl","ruby","bash","oracle","mysql","sql","clojure","scala","code","text","brainfuck","javascript","typescript","d","go","lua","erlang","sbcl","ocaml","pascal","python3","groovy","text_pseudo","objectivec","fsharp","visualbasic","cobol","tsql","lolcode","smalltalk","tcl","html","css","java8","db2","octave","r","xquery","racket","xml","rust","swift","fortran","elixir","ada","nim","julia","pypy","pypy3","cpp14","coffeescript"],defaultLanguage:"cpp",initialCode:null,initialLanguage:null,showTemplate:!0,forumMkdTool:!1,firepad:null,autoSaveNamespace:null,onSave:null,autoSave:null,firstLineNumber:1,enableTrackTyping:!1,typingTimespan:180,execute_button_text:"Execute Code",compile_button_text:"Run Code",submit_button_text:"Submit Code",lang_head_template:{},lang_tail_template:{},lang_template:{},lang_mime_mapping:{c:"text/x-csrc",cpp:"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp",haskell:"text/x-haskell",php:"text/x-php",python:"text/x-python",pypy:"text/x-python",pypy3:"text/x-python",perl:"text/x-perl",ruby:"text/x-ruby",bash:"text/x-sh",clojure:"text/x-scheme",scala:"text/x-scala",code:"text/plain",text:"text/plain",brainfuck:"text/plain",javascript:"text/javascript",typescript:"text/typescript",d:"text/x-d",go:"text/x-go",lua:"text/x-lua",erlang:"text/x-erlang",sbcl:"text/x-common-lisp",ocaml:"text/x-ocaml",pascal:"text/x-pascal",python3:"text/x-python",groovy:"text/x-groovy",text_pseudo:"text/plain",objectivec:"text/x-csrc",fsharp:"text/x-fsharp",visualbasic:"text/x-vb",cobol:"text/x-cobol",smalltalk:"text/x-stsrc",tcl:"text/x-tcl",html:"text/html",css:"text/css",java8:"text/x-java",db2:"text/x-plsql",octave:"text/x-octave",r:"text/x-rsrc",xquery:"application/xquery",racket:"text/x-scheme",xml:"text/xml",rust:"text/x-rustsrc",swift:"text/swift",elixir:"text/elixir",fortran:"text/x-fortran",ada:"text/x-adasrc",nim:"text/nim",julia:"text/x-julia",oracle:"text/x-plsql",tsql:"text/x-plsql",mysql:"text/x-plsql",sql:"text/x-plsql",cpp14:"text/x-c++src",coffeescript:"text/x-coffeescript"},lang_display_mapping:{c:"C",cpp:"C++",java:"Java 7",csharp:"C#",haskell:"Haskell",php:"PHP",python:"Python 2",pypy:"Pypy 2",pypy3:"Pypy 3",ruby:"Ruby",perl:"Perl",bash:"BASH",oracle:"Oracle",mysql:"MySQL",sql:"SQL",clojure:"Clojure",scala:"Scala",code:"Generic",text:"Plain Text",brainfuck:"Brainfuck",javascript:"JavaScript",typescript:"TypeScript",lua:"Lua",sbcl:"Common Lisp (SBCL)",erlang:"Erlang",go:"Go",d:"D",ocaml:"OCaml",pascal:"Pascal",python3:"Python 3",groovy:"Groovy",objectivec:"Objective-C",text_pseudo:"Plain Text",fsharp:"F#",visualbasic:"VB.NET",cobol:"COBOL",tsql:"MS SQL Server",lolcode:"LOLCODE",smalltalk:"Smalltalk",tcl:"Tcl",whitespace:"Whitespace",css:"CSS",html:"HTML",java8:"Java 8",db2:"DB2",octave:"Octave",r:"R",xquery:"XQuery",racket:"Racket",xml:"XML",rust:"Rust",swift:"Swift",elixir:"Elixir",fortran:"Fortran",ada:"Ada",nim:"Nim",julia:"Julia",cpp14:"C++14",coffeescript:"CoffeeScript"},default_head_end:{c:"/* Head ends here */",cpp:"/* Head ends here */",java:"/* Head ends here */",csharp:"/* Head ends here */",haskell:"-- Head ends here",php:"/* Head ends here */",python:"# Head ends here",pypy:"# Head ends here",pypy3:"# Head ends here",perl:"# Head ends here",ruby:"# Head ends here",bash:"# Head ends here",clojure:"; Head ends here",scala:"/* Head ends here */",sbcl:"; Head ends here",lua:"-- Head ends here",javascript:"/* Head ends here */",typescript:"/* Head ends here */",pascal:"{ Head ends here }",python3:"# Head ends here",groovy:"// Head ends here",objectivec:"// Head ends here",fsharp:"// Head ends here",visualbasic:"' Head ends here",cobol:"* Head ends here",lolcode:"BTW Head ends here",smalltalk:'" Head ends here"',tcl:"# Head ends here",whitespace:"Head ends here",html:"<!-- Head ends here -->",css:"/* Head ends here */",java8:"/* Head ends here */",db2:"/* Head ends here */",octave:"# Head ends here",r:"# Head ends here",xquery:"(: Head ends here :)",racket:"; Head ends here",xml:"<!-- Head ends here -->",rust:"// Head ends here",elixir:"# Head ends here",fortran:"! Head ends here",ada:"-- Head ends here",nim:"# Head ends here",julia:"# Head ends here",cpp14:"/* Head ends here */",coffeescript:"# Head ends here"},lang_fold_mapping:{c:"brace",cpp:"brace",java:"brace",csharp:"brace",haskell:"indent",php:"brace",python:"indent",pypy:"indent",pypy3:"indent",ruby:"indent",perl:"brace",bash:"brace",oracle:"indent",mysql:"indent",sql:"indent",clojure:"indent",scala:"brace",code:"brace",text:"indent",brainfuck:"indent",javascript:"brace",typescript:"brace",lua:"indent",sbcl:"indent",erlang:"indent",go:"brace",d:"brace",ocaml:"indent",pascal:"indent",python3:"indent",groovy:"brace",objectivec:"brace",text_pseudo:"indent",fsharp:"indent",visualbasic:"indent",cobol:"indent",lolcode:"indent",smalltalk:"indent",tcl:"brace",whitespace:"indent",html:"tag",css:"brace",java8:"brace",db2:"indent",octave:"indent",r:"brace",xquery:"indent",racket:"brace",xml:"tag",rust:"brace",swift:"brace",elixir:"indent",fortran:"indent",ada:"indent",nim:"indent",julia:"indent",cpp14:"brace",coffeescript:"indent"},default_tail_start:{c:"/* Tail starts here */",cpp:"/* Tail starts here */",java:"/* Tail starts here */",csharp:"/* Tail starts here */",haskell:"-- Tail starts here",php:"/* Tail starts here */",python:"# Tail starts here",pypy:"# Tail starts here",pypy3:"# Tail starts here",perl:"# Tail starts here",ruby:"# Tail starts here",bash:"# Tail starts here",clojure:"; Tail starts here",scala:"/* Tail starts here */",sbcl:"; Tail starts here",lua:"-- Tail starts here",javascript:"/* Tail starts here */",typescript:"/* Tail starts here */",pascal:"{ Tail starts here }",python3:"# Tail starts here",groovy:"// Tail starts here",objectivec:"// Tail starts here",fsharp:"// Tail starts here",visualbasic:"' Tail starts here",cobol:"* Tail starts here",lolcode:"BTW Tail starts here",smalltalk:'" Tail starts here"',tcl:"# Tail starts here",whitespace:"Tail starts here",html:"<!-- Tail starts here -->",css:"/* Tails starts here */",java8:"/* Tail starts here */",db2:"/* Tail starts here */",octave:"# Tail starts here ",r:"# Tail starts here ",xquery:"(: Tail starts here :)",racket:"; Tail starts here",xml:"<!-- Tail starts here -->",rust:"// Tail starts here",swift:"// Tail starts here",elixir:"# Tail starts here",fortran:"! Tail starts here",ada:"-- Tail starts here",nim:"# Tail starts here",julia:"# Tail starts here",cpp14:"/* Tail starts here */",coffeescript:"# Tail starts here"},lang_default_text:{c:"#include <stdio.h>\n#include <string.h>\n#include <math.h>\n#include <stdlib.h>\n\nint main() {\n\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */    \n    return 0;\n}\n",cpp:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",java:"import java.io.*;\nimport java.util.*;\nimport java.text.*;\nimport java.math.*;\nimport java.util.regex.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",csharp:"using System;\nusing System.Collections.Generic;\nusing System.IO;\nclass Solution {\n    static void Main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution */\n    }\n}",php:'<?php\n$_fp = fopen("php://stdin", "r");\n/* Enter your code here. Read input from STDIN. Print output to STDOUT */\n\n?>',ruby:"# Enter your code here. Read input from STDIN. Print output to STDOUT",python:"# Enter your code here. Read input from STDIN. Print output to STDOUT",pypy:"# Enter your code here. Read input from STDIN. Print output to STDOUT",pypy3:"# Enter your code here. Read input from STDIN. Print output to STDOUT",perl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",haskell:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",clojure:"; Enter your code here. Read input from STDIN. Print output to STDOUT\n;",lua:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",sbcl:";; Enter your code here. Read input from STDIN. Print output to STDOUT",erlang:"% Enter your code here. Read input from STDIN. Print output to STDOUT\n% Your class should be named solution\n\n-module(solution).\n-export([main/0]).\n\nmain() ->\n	.\n",scala:"object Solution {\n\n    def main(args: Array[String]) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution\n*/\n    }\n}",go:'package main\nimport "fmt"\n\nfunc main() {\n //Enter your code here. Read input from STDIN. Print output to STDOUT\n}',javascript:'function processData(input) {\n    //Enter your code here\n} \n\nprocess.stdin.resume();\nprocess.stdin.setEncoding("ascii");\n_input = "";\nprocess.stdin.on("data", function (input) {\n    _input += input;\n});\n\nprocess.stdin.on("end", function () {\n   processData(_input);\n});\n',typescript:'function processData(input) {\n    //Enter your code here\n} \n\nprocess.stdin.resume();\nprocess.stdin.setEncoding("ascii");\n_input = "";\nprocess.stdin.on("data", function (input) {\n    _input += input;\n});\n\nprocess.stdin.on("end", function () {\n   processData(_input);\n});\n',d:"/* Enter your code here. Read input from STDIN. Print output to STDOUT */",ocaml:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",pascal:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",groovy:"//Enter your code here. Read input from STDIN. Print output to STDOUT",text:"",objectivec:"//Enter your code here. Read input from STDIN. Print output to STDOUT",fsharp:"//Enter your code here. Read input from STDIN. Print output to STDOUT",visualbasic:"'Enter your code here. Read input from STDIN. Print output to STDOUT",cobol:"*Enter your code here. Read input from STDIN. Print output to STDOUT",lolcode:"BTW Enter your code here. Read input from STDIN. Print output to STDOUT",smalltalk:'"Enter your code here. Read input from STDIN. Print output to STDOUT"',tcl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",whitespace:"Enter your code here. Read input from STDIN. Print output to STDOUT",html:"<!-- Enter your code here -->",css:"/* Enter your code here*/",java8:"import java.io.*;\nimport java.util.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",octave:"# Enter your code here. Read input from STDIN. Print output to STDOUT",r:"# Enter your code here. Read input from STDIN. Print output to STDOUT",xquery:"(: Enter your code here. Read input from STDIN. Print output to STDOUT :)",racket:"#lang racket\n; Enter your code here. Read input from STDIN. Print output to STDOUT",xml:"<!-- Enter your code here -->",rust:"// Enter your code here ",swift:"// Enter your code here ",elixir:"defmodule Solution do\n#Enter your code here. Read input from STDIN. Print output to STDOUT\nend",fortran:"! Enter your code here ",ada:"with Ada.Text_IO, Ada.Integer_Text_IO;\nuse Ada;\n\nprocedure Solution is\n-- Enter your code here. Read input from STDIN. Print output to STDOUT\n\n\nend Solution",nim:"# Enter your code here ",julia:"# Enter your code here ",cpp14:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",coffeescript:"# Enter your code here"}},headerTemplate:'<% if (showHeader) { %>\n<div class="clearfix grey-header fixed-hand0 cap plL plR psT psB" style="position: relative;">\n  <div class="msT pull-left"><em id="status-text"><%-statusText%></em></div>\n  <% if (enableVersioning) { %>\n  <div class="fork-dialog cs-dialog hide">\n    <div class="header">Fork <span class="version-seq"></span>\n        <i data-analytics="CodeShellForkCode" data-attr1="Cancel" class="icon--single icon-cancel-small close-fork-dialog cursor-pointer pull-right psR"></i>\n    </div>\n    <div class="body">\n      <p class="grey-msg">past buffers are marked read only, you wont be able to edit your current buffer without forking it</p>\n      <div class="m msT">\n        <button data-analytics="CodeShellForkCode" data-attr1="ForkCurrentBuffer" class="btn btn-primary fork-version" data-action="fork">Fork <span class="version-seq"></span></button>&nbsp;&nbsp;\n        <button data-analytics="CodeShellForkCode" data-attr1="CreateNewBuffer" class="btn btn-primary fork-version" data-action="orphan">Create New Buffer</button>\n      </div>\n    </div>\n  </div>\n  <div class="fork-limit-reached-dialog cs-dialog hide">\n    <div class="header">Fork Limit Reached</div>\n    <div class="body">\n      <p class="grey-msg">You can&rsquo;t create more than 20 buffers, please delete one of your old bufferes to create a new buffer.</p>\n      <div class="m msT">\n        <button class="btn close-fork-limit-reached-dialog">OK</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="delete-version-dialog cs-dialog hide">\n    <div class="header">Delete <span class="version-seq"></span></div>\n    <div class="body">\n      <p class="grey-msg">Are you sure you want to delete <strong><span class="version-seq"></span></strong>? This action can&rsquo;t be undone.</p>\n      <div class="m msT">\n        <button class="btn delete-version-button">Yes</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="pull-left no-select">\n    <p style="padding-top: 8px;">\n      <strong class="version-name">Current Buffer</strong>\n      <span class="gray-text version-meta">(saved locally, editable)</span>\n      &nbsp;&nbsp;\n      <a data-analytics="CodeShellShowForkOptions" class="fork-this-version"><i class="icon--grey cursor icon-flow-branch"></i></a>\n      <a data-analytics="CodeShellShowVersionTimeline" class="show-version-timeline"><i class="icon--grey cursor icon-back-in-time"></i></a>\n      <a class="delete-active-version hide"><i class="icon--grey cursor icon-trash"></i></a>\n    </p>\n  </div>\n  <% } %>\n  <% if(showFileTree && adminView) { %>\n  <div class=\'pull-left btn-group\' id=\'js-file-permissions\'>\n    <a class=\'cursor btn btn-white\' data-perm=\'1\' href=\'#\'>Hidden</a>\n    <a class=\'cursor btn btn-white\' data-perm=\'2\' href=\'#\'>List Only</a>\n    <a class=\'cursor btn btn-white\' data-perm=\'3\' href=\'#\'>Read Only</a>\n  </div>\n  <% } %>\n  <div class="pull-right">\n    <% if (customToolBar != null) { %>\n      <% _.each(customToolBar, function(button) { %>\n        <div class="inline">\n         <% if(button["type"] == "link") { %>\n            <a class=\'<%- button["classList"] %>\'> <%- button["text"] %> </a>\n         <% } %>\n         </div>\n        <% }) %>\n    <% } %>\n    <div class="inline large lines inverse pull-right msT msL">\n      <% if (showSave) { %>\n      <a href="javascript:;" class="cursor save-code no-select" id="save-code"><i class="icon-floppy icon--grey no-select"></i></a>\n      <% } %>\n      <% if (showFullScreen) { %>\n      <a class="restorefullscreen force-hide active-link no-select">\n          <i class="icon-resize-small-alt icon--grey no-select"></i></a>\n      <a class="fullscreen active-link no-select"\n         data-analytics="Switch to fullscreen"><i class="icon-resize-full-alt icon--grey no-select"></i></a>\n      <% } %>\n      <% if (layout == 1) { %>\n        <i id="vertical-icon" style="background-repeat: no-repeat; background-position: 50% 50%; border:none; float:left; margin-right: 7px;" class="orientation-icon js-tooltip" data-placement="bottom" title="Switch to vertical layout"></i>\n      <% } else if (layout == 2) { %>\n        <i id="horizontal-icon" style="background-repeat: no-repeat; background-position: 50% 50%; border:none; float:left; margin-right: 7px;" class="orientation-icon js-tooltip" data-placement="bottom" title="Switch to horizontal layout"></i>\n      <% } %>\n      <a class="hide" style="display:none;"></a>\n      <div style="position:relative; margin-left: 0px;">\n        <a class="cursor no-select" data-analytics="CodeShellShowPreferences" id="show-preferences"><i class="icon-cog icon--grey no-select"></i></a>\n        <div id="pref-pane"\n          style="position: absolute;right: -0.5em;top: 2em;z-index: 9;background: #fff;border: 1px solid #ddd;border-radius: 5px;padding: 10px;  width: 20em; display: none;">\n          <div style="position: absolute;width: 0;right: 0.8em;height: 0;border-left: 7px solid transparent;border-right: 7px solid transparent;border-bottom: 7px solid #ddd;top: -0.4em;"></div>\n          <% if (showMode) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Editor Mode</label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Emacs" class="cursor emacs btn btn-small btn-white editor-mode-button no-select" data-editor="emacs">Emacs</a>\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Normal" class="cursor default btn btn-small btn-white editor-mode-button no-select" data-editor="default">Normal</a>\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Vim" class="cursor vim btn btn-small btn-white editor-mode-button no-select" data-editor="vim">Vim</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <% if (showTheme) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Editor Theme</label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellEditorTheme" data-attr1="Light" class="cursor light btn btn-small btn-white editor-theme-button no-select btn-primary" data-editor="light">Light</a>\n                  <a data-analytics="CodeShellEditorTheme" data-attr1="Dark" class="cursor dark btn btn-small btn-white editor-theme-button no-select" data-editor="dark">Dark</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <div class="formgroup horizontal">\n            <label class="span5">Tab Spaces</label>\n            <div class="inline">\n              <div class="btn-group no-select">\n                <a data-analytics="CodeShellEditorSpace" data-attr1="2" class="cursor 2space btn btn-small btn-white editor-tabspace-button no-select" data-editor="2">2 spaces</a>\n                <a data-analytics="CodeShellEditorSpace" data-attr1="4" class="cursor 4space  btn btn-small btn-white editor-tabspace-button no-select btn-primary" data-editor="4">4 spaces</a>\n                <a data-analytics="CodeShellEditorSpace" data-attr1="8" class="cursor 8space btn btn-small btn-white editor-tabspace-button no-select" data-editor="8">8 spaces</a>\n              </div>\n            </div>\n          </div>\n          <% if (enableIntellisense) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Intellisense</label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellAutoComplete" data-attr1="Enable" class="cursor emacs btn btn-small btn-white editor-autocomplete-button no-select btn-primary" data-editor="true">Enable</a>\n                  <a data-analytics="CodeShellAutoComplete" data-attr1="Disable" class="cursor default btn btn-small btn-white editor-autocomplete-button no-select" data-editor="false">Disable</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <% if (customSetting != null) { %>\n            <% _.each(customSetting, function(setting) { %>\n            <div class="formgroup horizontal">\n              <label class="span5"> <%=setting["label"] %></label>\n               <% if(setting["type"] == "link") { %>\n                  <a class=\'<%- setting["classList"] %>\'> <%- setting["text"] %> </a>\n               <% } %>\n            </div>\n              <% }) %>\n          <% } %>\n        </div>\n      </div>\n    </div>\n    <div class="pull-right">\n      <div class="dummy-lang-container hide"></div>\n      <input type="hidden" id="select-lang">\n    </div>\n    <div class="clearfix"></div>\n  </div>\n</div>\n<% } %>\n<% if (enableVersioning) { %>\n<div class="version-timeline">\n  <div class="version-timeline-inner">\n    <div class="cross-line"></div>\n    <div class="start-slab pull-left"></div>\n    <% _.each (versionIds, function (version_id) { %>\n      <div class="version-ball pull-left cursor" data-version-id="<%= version_id %>"></div>\n    <% }); %>\n    <div class="current-version-ball green-bkg pull-left cursor"></div>\n  </div>\n</div>\n<% } %>',bodyTemplate:'<div class="hr_tour-code-solution movable-hand flex-row" style="display: flex;">\n  <% if (showFileTree) { %>\n  <div class="code-filetree">\n    <div id="filetree">\n    </div>\n  </div>\n  <% } %>\n  <div class="code-checker">\n    <div id="notification-message" class="clearfix grey-header cap <% if ( (!showNotification) || (!notificationMessage)){ %> hidden <% } %>"> <%= notificationMessage %></div>\n    <div class="code-editors">\n      <% if (showNonEditableHeadTail){ %>\n      <div class="code-head <% if(!adminView) { %>not-allowed<% } %>">\n        <% if(adminView) { %>\n        <div class="code-template">\n            Head\n            <span class=\'icon-help-circled txt-blue psL js-tooltip\' data-toggle=\'tooltip\' data-placement=\'right\' title=\'This will not be editable by candidates\'></span>\n        </div>\n        <% } %>\n        <textarea id="codeheadview" style="width:100%"/>\n      </div> <%}%>\n      <% if (dynamicMode) { %> <div class="loading-mode" style="display:none">Loading Editor... </div> <% } %>\n      <div class="code-body">\n        <% if(adminView && showNonEditableHeadTail) { %>\n        <div class="code-template">\n            Body\n            <span class=\'icon-help-circled txt-blue psL js-tooltip\' data-toggle=\'tooltip\' data-placement=\'right\' title=\'This will be editable by candidates\'></span>\n        </div>\n        <% } %>\n        <div contenteditable="true">\n          <textarea id="codeview" style="width:100%"></textarea>\n        </div>\n       </div>\n      <% if (showNonEditableHeadTail){ %>\n      <div class="code-tail <% if(!adminView) { %>not-allowed<% } %>">\n        <% if(adminView) { %>\n        <div class="code-template">\n            Tail\n            <span class=\'icon-help-circled txt-blue psL js-tooltip\' data-toggle=\'tooltip\' data-placement=\'right\' title=\'This will not be editable by candidates\'></span>\n        </div>\n        <% } %>\n        <textarea id="codetailview" style="width:100%"/>\n      </div> <%}%>\n      <div class="clearfix"></div>\n    </div>\n    <div id="codeeditor-statusbar" class="clearfix psA codeeditor_statusbar">\n      <span id="statusbar-mode"></span>\n      <div class="pull-right">\n        <span id="statusbar-line"></span>\n        <span id="statusbar-col"></span>\n        <span id="statusbar-count"></span>\n      </div>\n    </div>\n  </div>\n</div>',footerTemplate:'<div class="clearfix pmR pmL pmB plT fixed-hand1 codeshell-footer">\n  <div class="pull-right">\n    <% if (showExecute) { %>\n    <button class="btn bb-execute msR" data-analytics="Execute"><%= execute_button_text %></button>\n    <% } %>\n    <% if (showCompileTest) {  primaryClass= (compilePrimary ? "btn-primary": "")%>\n    <button class="btn bb-compile msR <%=primaryClass%>" data-analytics="Compile and Test"><%= compile_button_text %></button>\n    <% } %>\n    <% if (showSubmit) { primaryClass= (submitPrimary ? "btn-primary": "")%>\n    <button class="btn <%=primaryClass%> bb-submit ans-submit" data-analytics="Submit Code"><%= submit_button_text %></button>\n    <% } %>\n  </div>\n  <div class="pull-left inline">\n      <% if(showUploadCode) { %>\n      <button class="btn btn-text upload_file mlR" data-analytics="Upload File" type="button"><i class="icon-upload"></i><%= uploadCodeText %></button>\n      <% } %>\n      <% if(showDownloadCode) { %>\n      <a class="btn btn-text download_file mlR" data-analytics="Download File" href=\'<%= showDownloadCode %>\' target="_blank"><i class="icon-download"></i><%= downloadCodeText%></a>\n      <% } %>\n      <% if (showCustomInput) { %>\n      <div class="mmT">\n          <label for="customtestcase"><input type="checkbox" id="customtestcase"><span class="lmT msL">Test against custom input</span></label>\n          <textarea rows="5" id="custominput" style="display:none"></textarea>\n      </div>\n      <% } %>\n  </div>\n</div>',_create:function(){var e,opts,that,_ref;return this.state={},opts=this.getOptions(),this._stateChange("before_create"),this.ele_name=this.element.context.id,e=$(this.element),this.options=$.extend({},this._options,this.options),this.current_code=e.html(),e.empty(),e.append(_.template(this.headerTemplate,this.options)),e.append(_.template(this.bodyTemplate,this.options)),e.append(_.template(this.footerTemplate,this.options)),that=this,this.codeEditor=this._initCodeEditor(e.find("textarea#codeview")[0]),(null!=(_ref=opts.firepad)?_ref.enabled:void 0)&&(opts.firepad.codeEditor=this.codeEditor,setTimeout(function(_this){return function(){return _this._initFirepad(opts.firepad)}}(this))),this.options.showNonEditableHeadTail&&(this.codeEditorHead=this._initCodeEditor(e.find("textarea#codeheadview")[0],!this.options.adminView),this.codeEditorTail=this._initCodeEditor(e.find("textarea#codetailview")[0],!this.options.adminView)),this._bindBasicEvents(e),this._initializeAutoComplete(),this._suggestionBoxDisplayStatus=!1,this._autoCompleteReqestStatus=!1,this._autoCompleteSupportedLanguages=["java","c","cpp","csharp","ruby","php","python","java8","scala","groovy","python3","javascript","go"],this._bindVersionBall(),this._bindCurrentVersionBall(),this._bindVersioningEvents(e),this._changeTheme(),this._setTabSize(this.codeEditor.options.tabSize),this._initFileTree(e),this.changeLanguage(this.state.language,function(_this){return function(){return _this._internalStateChange("mode-loaded",!0),_this._check_created()}}(this)),this._internalStateChange("end-init",!0),this._check_created()},_stateChange:function(state){return this.state._=state,this._trigger(state)},_internalStateChange:function(state,value){var _base;return(_base=this.state).__||(_base.__={}),this.state.__[state]=value},_check_created:function(){return this.state.__&&this.state.__["end-init"]&&this.state.__["mode-loaded"]?this._stateChange("after_create"):void 0},_bindVersioningEvents:function(e){return e.find(".fork-this-version").click(function(_this){return function(ev){var dialog_class;return _this.options.versionIds&&_this.options.versionIds.length<20?(dialog_class=".fork-dialog",void 0===_this.ActiveVersionId||null===_this.ActiveVersionId?e.find(".fork-dialog .version-seq").html("Current Buffer"):e.find(".fork-dialog .version-seq").html("Buffer #"+(_.indexOf(_this.options.versionIds,_this.ActiveVersionId)+1))):dialog_class=".fork-limit-reached-dialog","none"===_this.element.find(dialog_class).css("display")?(_this.element.find(dialog_class).show(),$(ev.currentTarget).find("i").addClass("green-color")):(_this.element.find(dialog_class).hide(),$(ev.currentTarget).find("i").removeClass("green-color"))}}(this)),e.find(".show-version-timeline").click(function(_this){return function(ev){return"none"===_this.element.find(".version-timeline").css("display")?(_this.element.find(".version-timeline").show(),$(ev.currentTarget).find("i").addClass("green-color")):(_this.element.find(".version-timeline").hide(),$(ev.currentTarget).find("i").removeClass("green-color"))}}(this)),e.find(".fork-version").click(function(_this){return function(ev){var forked_data;return forked_data="orphan"===$(ev.currentTarget).attr("data-action")?{code:_this._getDefaultLangCode(_this.state.language),language:_this.state.language}:{code:_this.codeEditor.getValue(),language:_this.state.language},_this._forkNewBuffer(forked_data)}}(this)),e.find(".close-fork-dialog").click(function(_this){return function(ev){return _this.element.find(".fork-dialog").hide(),_this.element.find(".fork-this-version").find("i").removeClass("green-color")}}(this)),e.find(".close-fork-limit-reached-dialog").click(function(_this){return function(ev){return _this.element.find(".fork-limit-reached-dialog").hide(),_this.element.find(".fork-this-version").find("i").removeClass("green-color")}}(this)),e.find(".delete-active-version").click(function(_this){return function(ev){return $(ev.currentTarget).find("i").hasClass("green-color")?($(ev.currentTarget).find("i").removeClass("green-color"),e.find(".delete-version-dialog").hide()):null!==_this.ActiveVersionId?($(ev.currentTarget).find("i").addClass("green-color"),e.find(".delete-version-dialog").find(".version-seq").html("Buffer #"+(_.indexOf(_this.options.versionIds,_this.ActiveVersionId)+1)),e.find(".delete-version-dialog").show(),e.find(".delete-version-dialog").find(".delete-version-button").attr("data-version-id",_this.ActiveVersionId)):void 0}}(this)),e.find(".delete-version-button").click(function(_this){return function(ev){var next_version_index,that,version_id;return version_id=parseInt(e.find(".delete-version-button").attr("data-version-id")),next_version_index=_.indexOf(_this.options.versionIds,version_id),that=_this,$.ajax({url:_this.options.versioningRestUrl,type:"DELETE",data:{version_id:version_id},success:function(data){var $el;return that.options.versionIds=_.reject(that.options.versionIds,function(num){return num===version_id}),that.element.find(".version-ball[data-version-id="+version_id+"]").remove(),$el=next_version_index<that.options.versionIds.length?that.element.find(".version-ball[data-version-id="+that.options.versionIds[next_version_index]+"]"):that.element.find(".current-version-ball"),$el.click(),e.find(".delete-active-version").find("i").removeClass("green-color"),e.find(".delete-version-dialog").hide()}})}}(this))},_bindBasicEvents:function(e){var that;return that=this,this.codeEditor.on("update",function(e){return that._updateStatusBar(that)}),this.codeEditor.on("cursorActivity",function(e){return that._updateStatusPosition(e)}),this.codeEditor.on("focus",function(e){return that.options.focusLogged?that.codeEditor.off("focus"):(that.options.focusLogged=!0,that.triggerAnalyticsEvent("focus","CodeShellUserIsInsideTheEditor"))}),this.options.showNonEditableHeadTail&&(this.codeEditorHead.on("cursorActivity",function(e){return that._updateStatusPosition(e)}),this.codeEditorTail.on("cursorActivity",function(e){return that._updateStatusPosition(e)})),this.options.adminView&&(this.options.showNonEditableHeadTail&&(this.codeEditorHead.on("change",function(cm){return that._updateLangHeadCode(that,cm),that._updateTailEditorLineNumber(!0)}),this.codeEditorTail.on("change",function(cm){return that._updateLangTailCode(that,cm)})),this.codeEditor.on("change",function(cm){return that._updateLangCode(that,cm)})),this.codeEditor.on("change",function(e){return that._saveLangCode(that),that.options.showNonEditableHeadTail?that._updateTailEditorLineNumber():void 0;
}),this.codeEditor.on("keydown",function(e){return that._totalCharactersTyped+=1,that.options.enableTrackTyping?that.setTypingEvent():void 0}),this.codeEditor.on("viewportChange",function(e){return that._growEditor()}),this._shiftPressed=!1,this.options.enableIntellisense&&this.codeEditor.on("keyup",function(cm,e){16===e.keyCode&&(that._shiftPressed=!1),190===e.keyCode&&that._shiftPressed===!1&&that._enableIntellisenseFunc(cm)}),this.options.enableIntellisense&&this.codeEditor.on("keydown",function(cm,e){16===e.keyCode&&(that._shiftPressed=!0),that._autoCompleteReqestStatus===!0&&(that._autoCompleteReqestStatus=!1)}),this.codeEditor.on("blur",function(){return that._autoCompleteReqestStatus===!0?that._autoCompleteReqestStatus=!1:void 0}),e.find("#select-lang").change(function(ev){return $(e)&&that.options.enableLanguageChangeHook?that._trigger("changinglanguage",{},{yes:function(_this){return function(){return that._changeLanguage(ev,that)}}(this),no:function(_this){return function(){var currentlang;return currentlang=that.state.language,$("#select-lang").select2("val",that.state.language)}}(this),from:that.state.language,to:$(ev.currentTarget).select2("val")}):that._changeLanguage(ev,that)}),e.find("#save-code").click(function(e){return that._saveCode(e,that)}),e.find("#select-lang").on("select2-close",function(e){return setTimeout(function(){return that.focusEditor(that)},100)}),e.find(".editor-mode-button").click(function(e){return that._setEditorMode(e,that),that._updateStatusBar(that)}),e.find(".editor-tabspace-button").click(function(e){return that._setTabSize($(e.currentTarget).attr("data-editor"),e)}),e.find("button.bb-execute").click(function(e){return that._checkAndSave(null,null,that,function(){var data;return data={},data.custominput=$(that.element).find("#custominput").val(),that._trigger("execute",{},data)})}),e.find("button.bb-compile").click(function(e){var data;return that.options.showFileTree?that._checkAndSave(null,null,that,function(){var data;return data={},that._trigger("compile",{},data)}):(data={code:that.codeEditor.getValue(),language:that.state.language},that.options.showCustomInput&&$(that.element).find("#customtestcase").prop("checked")&&(data.custominput=$(that.element).find("#custominput").val()),that._trigger("compile",{},data))}),_.each(this.options.customSetting,function(button){return button.classList&&button.eventName?e.find("a[class='"+button.classList+"']").click(function(e){return that._trigger(button.eventName,{},{})}):void 0}),_.each(this.options.customToolBar,function(button){return button.classList&&button.eventName?e.find("a[class='"+button.classList+"']").click(function(e){return that._trigger(button.eventName,{},{})}):void 0}),e.find("button.bb-submit").click(function(e){var data;return that.options.showFileTree?that._checkAndSave(null,null,that,function(){var data;return data={},that.triggerAnalyticsEvent("change","CodeShellTotalCharactersTypedBeforeSubmit",that._totalCharactersTyped),that._trigger("submit",{},data)}):(data={code:that.codeEditor.getValue(),language:that.state.language},that.options.showCustomInput&&$(that.element).find("#customtestcase").prop("checked")&&(data.custominput=$(that.element).find("#custominput").val()),that.triggerAnalyticsEvent("change","CodeShellTotalCharactersTypedBeforeSubmit",that._totalCharactersTyped),that._trigger("submit",{},data))}),e.find("#customtestcase").click(function(e){return $(that.element).find("#custominput").toggle(this.checked)}),e.find("#show-preferences").click(function(_this){return function(ev){var $pref_pane;return $pref_pane=e.find("#pref-pane"),"none"===$pref_pane.css("display")?($(ev.currentTarget).find("i").addClass("green-color"),$pref_pane.show(),_this.element.find("#tab-spaces").val(_this.codeEditor.options.tabSize)):($(ev.currentTarget).find("i").removeClass("green-color"),$pref_pane.hide())}}(this)),e.click(function(_this){return function(ev){var $pref_pane,menu;return $pref_pane=e.find("#pref-pane"),menu=$pref_pane.parent(),menu.is(ev.target)||0!==menu.has(ev.target).length?void 0:(e.find("i.green-color").removeClass("green-color"),$pref_pane.hide())}}(this)),e.find(".editor-theme-button").click(function(_this){return function(ev){var theme;return theme=$(ev.currentTarget).attr("data-editor"),_this._changeTheme(theme),_this.triggerAnalyticsEvent("change","CodeShellChangeTheme",theme)}}(this)),e.find("#tab-spaces").keyup(function(_this){return function(ev){return _this._setTabSize($(ev.currentTarget).val()),_this.triggerAnalyticsEvent("change","CodeShellChangeTabSpaces",$(ev.currentTarget).val())}}(this))},_initFileTree:function(e){var file_tree_config,that;return this.options.showFileTree&&(that=this,this.currentFile=null,file_tree_config={core:{multiple:!1,data:this.options.showFileTree.data,check_callback:function(operation,node,node_parent,node_position,more){var cb;switch(cb=function(node,node_id){var tree;return null==node_id&&(node_id=null),node&&(tree=$.jstree.reference("#filetree"),node_id&&node.id!==node_id&&tree.set_id(node,node_id),tree.refresh_node(node)),that._executingFileOps=!1},operation){case"create_node":that.options.showFileTree.onCreate&&(that._executingFileOps=!0,that.options.showFileTree.onCreate(node,node_parent,cb));break;case"rename_node":node.text!==node_position&&that.options.showFileTree.onRename&&(that._executingFileOps=!0,that.options.showFileTree.onRename(node,node_parent,node_position,cb))}return!0}},types:{file:{icon:"jstree-file"}},contextmenu:{items:{}},plugins:["wholerow","types","contextmenu"]},that.options.showFileTree.onCreate&&(file_tree_config.contextmenu.items.create={label:"New",_disabled:function(data){var inst,obj;return that.options.adminView?!1:(inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),"file"===obj.type&&(obj=inst.get_node(obj.parent)),"#"===obj.id?!1:obj.original.permission<4?!0:!1)},action:function(){return console.log("always called before")},submenu:{create_folder:{separator_after:!0,label:"Folder",action:function(data){var inst,obj;return inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),"file"===obj.type&&(obj=inst.get_node(obj.parent)),inst.create_node(obj,{id:Date.now().toString(36),text:"New_Folder",type:"default",permission:4},"last",function(new_node){return setTimeout(function(){return inst.edit(new_node)},0)})}},create_file:{label:"File",action:function(data){var inst,obj;return inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),"file"===obj.type&&(obj=inst.get_node(obj.parent)),inst.create_node(obj,{id:Date.now().toString(36),text:"New_File",type:"file",permission:4},"last",function(new_node){return setTimeout(function(){return inst.edit(new_node)},0)})}}}}),that.options.showFileTree.onRename&&(file_tree_config.contextmenu.items.rename={label:"Rename",_disabled:function(data){var inst,obj;return that.options.adminView?!1:(inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),obj.original.permission<4?!0:!1)},action:function(data){var inst,obj;return inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),inst.edit(obj)}}),that.options.showFileTree.onDelete&&(file_tree_config.contextmenu.items["delete"]={label:"Delete",_disabled:function(data){var inst,obj;return that.options.adminView?!1:(inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),obj.original.permission<4?!0:!1)},action:function(data){var cb,inst,node,node_parent,obj;return inst=$.jstree.reference(data.reference),obj=inst.get_node(data.reference),node=inst.is_selected(obj)?inst.get_selected():obj,cb=function(access){return null==access&&(access=!0),that._executingFileOps=!1,access?inst.delete_node(node):void 0},node_parent=inst.get_parent(node),that.options.showFileTree.onDelete?(that._executingFileOps=!0,that.options.showFileTree.onDelete(node,node_parent,cb)):void 0}}),e.find("#filetree").jstree(file_tree_config).on("changed.jstree",function(e,treeObj){return that._checkAndSave(e,treeObj,that)}),this.options.adminView)?e.find("#js-file-permissions a").off("click").on("click",function(evt){return that._updateFilePermission(evt,that)}):void 0},_updateFilePermission:function(evt,that){var elem,node,perm;return evt.preventDefault(),elem=$(evt.currentTarget),that.fileTree||(that.fileTree=$.jstree.reference("#filetree")),elem.hasClass("active")?(elem.removeClass("active btn-primary"),perm=4):(elem.addClass("active btn-primary").siblings().removeClass("active btn-primary"),perm=elem.data("perm")),node=that.fileTree.get_selected(!0)[0],node.original.permission=perm,that.options.showFileTree.onPermissionUpdate(node)},_checkAndSave:function(_this){return function(ev,treeObj,that,cb){var currentValue;return null==cb&&(cb=null),that.fileTree||(that.fileTree=$.jstree.reference("#filetree")),treeObj?treeObj.node?(that.options.adminView&&treeObj.node.original.permission<4?$("#js-file-permissions").find("a[data-perm="+treeObj.node.original.permission+"]").addClass("active btn-primary").siblings().removeClass("active btn-primary"):$("#js-file-permissions a").removeClass("active btn-primary"),"file"!==treeObj.node.type?that._showLoading('<i class="icon--single icon-attention"> </i>You have selected a folder, please select a file from the left pane to open its contents.'):(that._showLoading(),that.currentFile&&(that.options.adminView||that.currentFile.original.permission>3)&&(currentValue=that.value(),that.currentFile.original.fileContents.code!==currentValue.code&&(that.currentFile.original.fileContents=currentValue,that._executingFileOps=!0,that.options.showFileTree.onSave(that.currentFile,function(){return that._executingFileOps=!1}))),that.options.adminView||treeObj.node.original.permission>2?null==treeObj.node.original.fileContents?(that._executingFileOps=!0,that.options.showFileTree.fetch(treeObj,function(newTreeObj){var check_lang;return newTreeObj.node.id!==$("#filetree").jstree("get_selected")[0]&&that.currentFile||(_.isString(newTreeObj.node.original.fileContents)?(that.currentFile=newTreeObj.node,that._showLoading(newTreeObj.node.original.fileContents)):(check_lang=newTreeObj.node.original.fileContents.language,newTreeObj.node.original.fileContents.language=check_lang?check_lang:"text",that.currentFile=newTreeObj.node,that.setValue(newTreeObj.node.original.fileContents,{clearHistory:!0}),that._setNotifyFileReadOnly(treeObj,that))),that._executingFileOps=!1})):treeObj.node.id!==$("#filetree").jstree("get_selected")[0]&&that.currentFile?void 0:_.isString(treeObj.node.original.fileContents)?(that._showLoading(treeObj.node.original.fileContents),that.currentFile=treeObj.node):(that.currentFile=treeObj.node,that.setValue(treeObj.node.original.fileContents,{clearHistory:!0}),that._setNotifyFileReadOnly(treeObj,that)):that._showLoading("You don't have permission to access this file."))):void 0:void(!that._executingFileOps&&that.currentFile&&(that.options.adminView||that.currentFile.original.permission>3)?(currentValue=that.value(),that.currentFile.original.fileContents.code===currentValue.code?cb&&cb():(that.currentFile.original.fileContents=currentValue,that._executingFileOps=!0,that.options.showFileTree.onSave(that.currentFile,function(){return that._executingFileOps=!1,cb?cb():void 0}))):cb&&cb())}}(this),_setNotifyFileReadOnly:function(treeObj,that){return that.options.adminView||treeObj.node.original.permission>3?(that.codeEditor.setOption("readOnly",!1),that.hideNotification()):(that.codeEditor.setOption("readOnly",!0),that.setNotificationMessage('<div class="pjL pmA"> <i class="icon--single icon-lock msR"/>This file is read only.</div>'))},_initializeAutoComplete:function(){var e,that;return this.options.enableIntellisense?(e=$(this.element),"undefined"==typeof $.cookie("enableIntellisenseUserPref")?this._setAutoCompleteState(!0,!0):"true"===$.cookie("enableIntellisenseUserPref")?this._setAutoCompleteState(!0,!1):"false"===$.cookie("enableIntellisenseUserPref")?this._setAutoCompleteState(!1,!1):this._setAutoCompleteState(!0,!0),that=this,e.find(".editor-autocomplete-button").click(function(_this){return function(ev){"true"===$(ev.currentTarget).attr("data-editor")?(_this._setAutoCompleteState(!0,!0),that.triggerAnalyticsEvent("change","CodeShellAutoComplete","on")):(_this._setAutoCompleteState(!1,!0),that.triggerAnalyticsEvent("change","CodeShellAutoComplete","off"))}}(this))):void 0},_copyToCurrentBuffer:function(data){var e,that;return e=$(this.element),e.find(".version-ball").removeClass("green-bkg"),e.find(".version-name").html("Current Buffer"),e.find(".version-meta").html("(saved locally, editable)"),e.find(".current-version-ball").hasClass("green-bkg")||e.find(".current-version-ball").addClass("green-bkg"),this.versionGetXhr&&void 0===this.versionGetXhr.status&&this.versionGetXhr.abort(),this._showLoading("Loading current buffer... "),this.codeEditor.setOption("readOnly",!1),this.setValue(data),this.ActiveVersionId=null,this.saveLangCode(),that=this,setTimeout(function(){return that._hideLoading(),$(that.element).find(".dummy-lang-container").hide(),$(that.element).find("#select-lang").siblings(".select2-container").show(),that.element.find(".delete-active-version").hide(),that.ActiveVersionId=null},100)},_forkNewBuffer:function(forked_data){var data,e,that;return null==forked_data&&(forked_data=null),e=$(this.element),data=void 0===this.ActiveVersionId||null===this.ActiveVersionId?{code:this.codeEditor.getValue(),language:this.state.language}:{code:this._getLangCode(this.currentBufferLang),language:this.currentBufferLang},this._showLoading("Saving previous buffer on cloud... "),this.element.find(".close-fork-dialog").click(),that=this,$.ajax({url:this.options.versioningRestUrl,type:"POST",data:data,success:function(data){return forked_data&&that._copyToCurrentBuffer(forked_data),that._hideLoading(),"none"===e.find(".version-timeline").css("display")&&e.find(".show-version-timeline").click(),e.find(".version-ball").removeClass("green-bkg"),e.find(".version-ball").hasClass("green-bkg")||e.find(".current-version-ball").addClass("green-bkg"),that._addNewVersion(data.id)}})},forkNewBuffer:function(data){var dialog_class,that;return this.options.enableVersioning?this.options.versionIds&&this.options.versionIds.length<20?(this._forkNewBuffer(data),that=this,setTimeout(function(){return that.saveLangCode()},0)):(dialog_class=".fork-limit-reached-dialog","none"===this.element.find(dialog_class).css("display")?(this.element.find(dialog_class).show(),this.element.find(".fork-this-version i").addClass("green-color")):(this.element.find(dialog_class).hide(),this.element.find(".fork-this-version i").removeClass("green-color"))):this.setValue(data)},_bindCurrentVersionBall:function(){var e;return e=$(this.element),e.find(".current-version-ball").click(function(_this){return function(ev){var data;return data={code:_this._getLangCode(_this.currentBufferLang||_this.state.language),language:_this.currentBufferLang||_this.state.language},_this._copyToCurrentBuffer(data)}}(this))},_bindVersionBall:function(){var e;return e=$(this.element),e.find(".version-ball").unbind("click").click(function(_this){return function(ev){var that,version_id,version_seq;return version_id=parseInt($(ev.currentTarget).attr("data-version-id")),version_seq=_.indexOf(_this.options.versionIds,version_id)+1,e.find(".current-version-ball").hasClass("green-bkg")&&(_this.currentBufferLang=_this.state.language,_this.saveLangCode()),_this.element.find(".delete-active-version").hide(),e.find(".version-name").html("Buffer #"+version_seq),e.find(".version-meta").html("(saved on cloud, read-only)"),e.find(".version-ball").removeClass("green-bkg"),e.find(".current-version-ball").removeClass("green-bkg"),$(ev.currentTarget).hasClass("green-bkg")||$(ev.currentTarget).addClass("green-bkg"),that=_this,_this._showLoading("Looking up cloud for buffer #"+version_seq+"... "),_this.versionGetXhr&&void 0===_this.versionGetXhr.status&&_this.versionGetXhr.abort(),_this.versionGetXhr=$.ajax({url:_this.options.versioningRestUrl,type:"GET",data:{version_id:version_id},success:function(data){return that.setValue({code:data.source,language:data.language}),that.codeEditor.setOption("readOnly",!0),$(that.element).find(".dummy-lang-container").html(that.options.lang_display_mapping[data.language]).show(),$(that.element).find("#select-lang").siblings(".select2-container").hide(),that._hideLoading(),that.ActiveVersionId=version_id,that.element.find(".delete-active-version").show()}})}}(this))},_addNewVersion:function(version_id){var prev;return-1===_.indexOf(this.options.versionIds,version_id)?(this.options.versionIds.push(version_id),this.options.versionIds=_.sortBy(this.options.versionIds,function(num){return num}),prev=null,_.each(this.options.versionIds,function(version_id){var $el;return 0===this.element.find(".version-ball[data-version-id="+version_id+"]").length&&($el=null!==prev?this.element.find(".version-ball[data-version-id="+prev+"]"):this.element.find(".start-slab"),$el.after("<div class='version-ball pull-left cursor' data-version-id='"+version_id+"'></div>"),this._bindVersionBall()),prev=version_id},this)):void 0},_updateStatusBar:function(){var modeText;return modeText=function(){switch(this.codeEditor.options.keyMap){case"vim":return"--VIM--";case"vim-insert":return"-- INSERT --";case"emacs":return"EMACS";case"emacs-Ctrl-X":return"C-x-";default:return""}}.call(this),$(this.element).find("#statusbar-mode").text(modeText)},_updateStatusPosition:function(e){var pos,start_line;return pos=e.doc.getCursor(),start_line=e.getOption("firstLineNumber"),e=$(this.element),e.find("#statusbar-line").text("Line: "+(pos.line+start_line)),e.find("#statusbar-col").text("Col: "+(pos.ch+1))},_getThemeName:function(slug){return"dark"===slug?"ambiance":"default"},_changeTheme:function(editor_theme){var e;return null==editor_theme&&(editor_theme=null),e=$(this.element),editor_theme||(editor_theme=$.cookie("hacker_editor_theme")),"dark"!==editor_theme&&"light"!==editor_theme&&(editor_theme="light"),$.cookie("hacker_editor_theme",editor_theme,{path:"/",expires:365}),e.find(".editor-theme-button").removeClass("btn-primary"),e.find(".editor-theme-button[data-editor="+editor_theme+"]").addClass("btn-primary"),this.codeEditor.setOption("theme",this._getThemeName(editor_theme)),this.codeEditor.refresh()},_setTabSize:function(size,e){return size=parseInt(size),_.isNumber(size)&&!_.isNaN(size)&&this.codeEditor.options.tabSize!==size&&(this._saveUserOpts({tabSize:size,indentUnit:size}),this.codeEditor.setOption("tabSize",size),this.codeEditor.setOption("indentUnit",size)),e?($(e.currentTarget).parent().find(".editor-tabspace-button").removeClass("btn-primary"),$(e.currentTarget).addClass("btn-primary")):void 0},_setAutoCompleteState:function(state,update_cookie){var e;return null==update_cookie&&(update_cookie=!1),e=$(this.element),e.find(".editor-autocomplete-button").removeClass("btn-primary"),update_cookie&&$.cookie("enableIntellisenseUserPref",state,{path:"/",expires:365}),state?e.find(".editor-autocomplete-button[data-editor="+state+"]").addClass("btn-primary"):e.find(".editor-autocomplete-button[data-editor="+state+"]").addClass("btn-primary")},_parseJson:function(respData,customRendering){var that;return that=this,customRendering===!0?(respData.forEach(function(t){return t.render=function(elt,self,data){var divCompletionText,divMenuText,divTypeText;divTypeText=document.createElement("DIV"),divTypeText.className="CodeMirror-hint-divTypeText",divTypeText.appendChild(document.createTextNode(data.type)),divCompletionText=document.createElement("DIV"),divCompletionText.className="CodeMirror-hint-divCompletionText",divCompletionText.appendChild(document.createTextNode(" "+data.completion+" ")),divMenuText=document.createElement("DIV"),divMenuText.className="CodeMirror-hint-divMenuText",divMenuText.appendChild(document.createTextNode(""+data.menu+" ")),elt.appendChild(divTypeText),elt.appendChild(divCompletionText),elt.appendChild(divMenuText),elt.style.display="table-row"}}),respData):respData},_updateLoadingMessage:function(cm,retHintValues){var noKeyPress,options;noKeyPress=!0,options={completeSingle:!1,hint:function(cm){var inner;return noKeyPress===!0?noKeyPress=!1:retHintValues=[],inner={from:cm.getCursor(),to:cm.getCursor(),list:[]},inner.list=retHintValues,inner}},CodeMirror.showHint(cm,options.hint,options)},_cleanToken:function(token){var charCode,iterateToken;for(iterateToken=0;iterateToken<token.length&&(charCode=token.charCodeAt(iterateToken),!(charCode>47&&58>charCode||charCode>64&&91>charCode||charCode>96&&123>charCode||"_"===token[iterateToken]));)iterateToken++;return token=token.substr(iterateToken)},_filterSuggestions:function(list,token){var found,iterateList,matched,ptrToken,ptrWord,word;for(token=token.toLowerCase(),found=[],iterateList=0;iterateList<list.length;){for(word=list[iterateList].text.toLowerCase(),matched=1,ptrWord=0,ptrToken=0;ptrToken<token.length;){for(;word[ptrWord]!==token[ptrToken]&&ptrWord<word.length;)ptrWord++;if(ptrWord===word.length){matched=0;break}ptrToken++}1===matched&&found.push(list[iterateList]),iterateList++}return found},_adjustHeightSuggestionBox:function(hints){var adjustTop,box,cm,ele,height,hintsTop,newTop,pos,winH,winW;cm=this.codeEditor,pos=cm.cursorCoords(cm.getCursor()),winW=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),winH=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),box=hints.getBoundingClientRect(),ele=$("#CodeMirror-hint-infoDiv")[0],adjustTop=ele.offsetHeight,height=box.bottom+adjustTop-box.top,height>winH?(hints.style.height=winH-5-adjustTop+"px",newTop=parseInt(hints.style.top.substr(0,hints.style.top.length-2),10),newTop+=winH-5-adjustTop,$(ele).css("top",newTop+"px")):(hintsTop=parseInt(hints.style.top.substr(0,hints.style.top.length-2),10),hintsTop<pos.top&&hintsTop+(box.bottom-box.top)+adjustTop!==pos.top&&(hints.style.top=pos.top-adjustTop-(box.bottom-box.top)+"px",newTop=pos.top-adjustTop,$(ele).css("top",newTop+"px")))},_adjustWidthSuggestionBox:function(hints){var box,cm,editor,editorOffset,pos;cm=this.codeEditor,pos=cm.cursorCoords(cm.getCursor()),box=hints.getBoundingClientRect(),editor=$(cm.display.wrapper),editorOffset=editor.offset(),editor.width()>box.width?editorOffset.left+editor.width()>=box.right?hints.style.width=box.width:(hints.style.width=box.width,hints.style.left=pos.left-(box.right-(editorOffset.left+editor.width()))-5+"px"):(hints.style.left=editorOffset.left+"px",hints.style.width=editor.width()+"px")},_setMaxWidthCompletionText:function(hints){var curWidth,divCompletionText,iterateDivs,maxWidth,obj,startWidth;if(divCompletionText=hints.getElementsByClassName("CodeMirror-hint-divCompletionText"),divCompletionText.length>0)for(iterateDivs=divCompletionText.length-1;iterateDivs>=0;)obj=divCompletionText[iterateDivs],maxWidth=void 0,startWidth=void 0,maxWidth=hints.style.width,maxWidth=parseInt(maxWidth.substr(0,maxWidth.length-2)),curWidth=obj.offsetWidth,curWidth>maxWidth&&(curWidth=maxWidth-40,obj.style.maxWidth=curWidth+"px",obj.style.textOverflow="ellipsis"),iterateDivs--},_setMaxWidthMenuText:function(hints){var divMenuText,iterateDivs,obj,reqdWidth,startWidth;if(divMenuText=hints.getElementsByClassName("CodeMirror-hint-divMenuText"),divMenuText.length>0)for(iterateDivs=divMenuText.length-1;iterateDivs>=0;)obj=divMenuText[iterateDivs],reqdWidth=hints.style.width,reqdWidth=parseInt(reqdWidth.substr(0,reqdWidth.length-2)),startWidth=obj.offsetLeft,reqdWidth-=startWidth,obj.style.maxWidth=reqdWidth-20+"px",iterateDivs--},_removeShowHintWidget:function(cm){this._updateSuggestions(cm,[])},_updateSuggestions:function(cm,retHintValues){var options,tempRetHintValues,that;tempRetHintValues=retHintValues,that=this,options={completeSingle:!1,hint:function(cm){var inner,token;return retHintValues=tempRetHintValues,token=cm.getTokenAt(cm.getCursor()).string,token=that._cleanToken(token),token.length>0&&(retHintValues=that._filterSuggestions(retHintValues,token)),retHintValues=retHintValues.slice(0,100),inner={from:cm.getCursor(),to:cm.getCursor(),list:[]},inner.list=retHintValues,CodeMirror.on(inner,"shown",function(){that._suggestionBoxDisplayStatus=!0}),CodeMirror.on(inner,"close",function(){$("#CodeMirror-hint-infoDiv").remove(),that._suggestionBoxDisplayStatus=!1}),CodeMirror.on(inner,"select",function(completion,elt){var adjustTop,infoDiv,infoDivInfo,infoDivMenu;that._adjustWidthSuggestionBox($(".CodeMirror-hints")[0]),that._setMaxWidthMenuText($(".CodeMirror-hints")[0]),that._setMaxWidthCompletionText($(".CodeMirror-hints")[0]),(completion.menu.length>0||completion.meta.length>0)&&(completion.meta===completion.menu&&(completion.meta=""),$("#CodeMirror-hint-infoDiv").length>0?($("#CodeMirror-hint-infoDivMenu").text(completion.menu),$("#CodeMirror-hint-infoDivInfo").text(completion.meta),$("#CodeMirror-hint-infoDiv").css("width",$(elt).parent().css("width")),$("#CodeMirror-hint-infoDiv").css("left",$(elt).parent().css("left")),adjustTop=parseInt($(elt).parent().css("top").substr(0,$(elt).parent().css("top").length-2),10),adjustTop+=parseInt($(elt).parent().css("height").substr(0,$(elt).parent().css("height").length-2),10),$("#CodeMirror-hint-infoDiv").css("top",adjustTop+"px")):(infoDiv=document.createElement("ul"),infoDiv.id="CodeMirror-hint-infoDiv",$(elt.parentNode.parentNode).append($(infoDiv)),$(infoDiv).css("width",$(elt).parent().css("width")),$(infoDiv).css("left",$(elt).parent().css("left")),adjustTop=parseInt($(elt).parent().css("top").substr(0,$(elt).parent().css("top").length-2),10),adjustTop+=parseInt($(elt).parent().css("height").substr(0,$(elt).parent().css("height").length-2),10),$(infoDiv).css("top",adjustTop+"px"),infoDivMenu=document.createElement("span"),infoDivMenu.id="CodeMirror-hint-infoDivMenu",$(infoDivMenu).css("color","blue"),$(infoDivMenu).text(completion.menu),infoDivInfo=document.createElement("span"),infoDivInfo.id="CodeMirror-hint-infoDivInfo",$(infoDivInfo).css("color","#D757FA"),$(infoDivInfo).css("margin-left","10px"),$(infoDivInfo).text(completion.meta),$(infoDiv).append($(infoDivMenu)),$(infoDiv).append($(infoDivInfo)))),that._adjustHeightSuggestionBox($(".CodeMirror-hints")[0])}),CodeMirror.on(inner,"pick",function(completion){var startPoint,tempInnerEnd,tempInnerStart;startPoint=inner.to.ch-token.length,tempInnerStart={},tempInnerStart.line=inner.from.line,tempInnerStart.ch=startPoint,tempInnerEnd={},tempInnerEnd.line=inner.to.line,tempInnerEnd.ch=inner.to.ch,cm.replaceRange("",tempInnerStart,tempInnerEnd)}),inner}},CodeMirror.showHint(cm,options.hint,options)},_getLoadingData:function(){var data;return data=[],data.push({type:"",completion:"",menu:"Loading hints...   ",displayText:"Loading hints...   ",info:""}),data},_showAutoCompleteLoadingMsg:function(cm){var data,retHintValues;data=this._getLoadingData(),retHintValues=this._parseJson(data,!1),this._updateLoadingMessage(cm,retHintValues)},_enableIntellisenseFunc:function(cm){var data,e,language,retHintValues,that;return e=$(this.element),e.find("#auto-complete").prop("checked")!==!1?(language=this.state.language,__indexOf.call(this._autoCompleteSupportedLanguages,language)>=0?(this._autoCompleteReqestStatus=!0,data=JSON.stringify(this._getFullCodeOffsetLanguage(cm)),retHintValues=[],that=this,$.ajax({type:"POST",url:"https://autosuggest.hackerrank.com/autocomplete",data:data,dataType:"json",contentType:"application/json",success:function(data){return data.msg?(console.log("No suggestions obtained - error"),void that._removeShowHintWidget(cm)):void(that._autoCompleteReqestStatus===!0&&(retHintValues=that._parseJson(data,!0),that._updateSuggestions(cm,retHintValues)))}})):void this._removeShowHintWidget(cm)):void 0},_getFullCodeOffsetLanguage:function(cm){var autoCompleteInfo,code,headCode,language,lineCh,lineNum,numHeadLines,offset,requestStartTime,tailCode,token;for(language=this.state.language,code="",headCode=this._getLangHeadCode(language),0!==headCode.length&&(code+=headCode),code+="\n",numHeadLines=code.split("\n").length,numHeadLines-=1,offset=code.length,lineCh=cm.getCursor(),lineNum=0;lineNum<lineCh.line;)offset+=cm.getLine(lineNum).length+1,lineNum++;return offset+=lineCh.ch,code+=cm.getValue(),code+="\n",tailCode=this._getLangTailCode(language),0!==tailCode.length&&(code+=tailCode),code+="\n",token=cm.getTokenAt(lineCh).string,token=this._cleanToken(token),requestStartTime=Date.now(),autoCompleteInfo={column:lineCh.ch,WantDocumentationForEveryCompletionResult:"false",line:lineCh.line+numHeadLines,wordToComplete:token,code:code,offset:offset+1,fileType:language,requestStartTime:requestStartTime}},changeFirePadMode:function(lang){var firebase,langSettingsRef;return null==this.firepad?!1:(firebase=this.firepad.firebaseAdapter_,langSettingsRef=firebase.ref_.child("question/settings"),langSettingsRef.update({lang:lang}))},_initFirepad:function(firebaseOpts){var codeMirror,firebase,firebaseRef,langSettingsRef;return setTimeout(function(_this){return function(){return _this.firepadRead?void 0:_this._firepadFallback()}}(this),5e3),"undefined"==typeof Firebase||null===Firebase?void this._firepadFallback():(Firebase.INTERNAL.forceWebSockets(),firebaseRef=new Firebase(firebaseOpts.authUrl),codeMirror=firebaseOpts.codeEditor,firebaseRef.authWithCustomToken(""+firebaseOpts.authToken,function(_this){return function(error){return _this.firepadAuthReqCompleted=!0,null!=error?_this._firepadFallback():void 0}}(this)),this.firepad=Firepad.fromCodeMirror(firebaseRef,codeMirror,{richTextShortcuts:!1,richTextToolbar:!1}),firebase=this.firepad.firebaseAdapter_,langSettingsRef=firebase.ref_.child("question/settings"),langSettingsRef.on("value",function(_this){return function(langRef){var ln;return ln=langRef.val(),_this.state.language!==ln.lang?_this.changeLanguage(ln.lang):void 0}}(this)),this.firepadReadyCB=function(_this){return function(){return _this._firepadReady()}}(this),setTimeout(function(_this){return function(){var _ref;return _this.firepadRead||_this.firepadFallback||(null!=(_ref=_this.firepad)?_ref.ready:void 0)?void 0:(_this.fallbackCode=_this._getLangCode(_this.state.language),_this.fallbackKey=_this.getCurrentAutosavekey(),_this.setStatusText("Fetching code.. Please wait"))}}(this),700),this.firepad.on("ready",this.firepadReadyCB))},_firepadReady:function(){var opts;return this.setStatusText(""),this.firepad.isHistoryEmpty()&&(this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(this.state.language))),this.firepadRead=!0,opts=this.getOptions(),this._setAnswer(opts.firepad.readyCb)},_firepadFallback:function(){var _ref,_ref1,_ref2;return this.setStatusText(""),this.firepadFallback=!0,null==this.firepadRead&&(null!=(null!=(_ref=this.getOptions().firepad)?_ref.answer:void 0)?this._setAnswer(null!=(_ref1=this.options.firepad)?_ref1.readyFailCb:void 0):($.jStorage.set(this.fallbackKey,this.fallbackCode),this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(this.state.language)),null!=(_ref2=this.options.firepad)&&"function"==typeof _ref2.readyFailCb&&_ref2.readyFailCb())),null!=this.firepad?(this.firepad.firebaseAdapter_.ready_=!0,this.firepad.off("ready",this.firepadReadyCB),this.firepad.dispose(),this.firepad.firebaseAdapter_.zombie_=!0,this.firepad=void 0):void 0},_setAnswer:function(cb){var answer,code,language,opts,_ref;return opts=this.getOptions(),answer=null!=(_ref=opts.firepad)?_ref.answer:void 0,null==answer?void("function"==typeof cb&&cb()):(code=answer.code,language=answer.language,null==code||null==language?void("function"==typeof cb&&cb()):this.changeLanguage(language,function(_this){return function(){return _this.codeEditor.setValue(code),"function"==typeof cb?cb():void 0}}(this)))},_initCodeEditor:function(t,readOnly){var e,opts,that,_ref,_ref1,_ref2;return null==readOnly&&(readOnly=!1),opts=this._getUserOpts(),e=$(this.element),e.find(".editor-mode-button[data-editor="+opts.keyMap+"]").addClass("btn-primary"),this._initAutoSave(),this.options.language=this.state.language=this.options.initialLanguage&&(_ref=this.options.initialLanguage,__indexOf.call(this.options.languages,_ref)>=0)?this.options.initialLanguage:opts.userPreferredLang&&(_ref1=opts.userPreferredLang,__indexOf.call(this.options.languages,_ref1)>=0)?opts.userPreferredLang:this.options.defaultLanguage&&(_ref2=this.options.defaultLanguage,__indexOf.call(this.options.languages,_ref2)>=0)?this.options.defaultLanguage:this.options.languages.length>0?this.options.languages[0]:"text",this._initLanguageSelecter(),opts.mode=this.options.lang_mime_mapping[this.state.language],opts.specialChars=/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,that=this,this.options.enableIntellisense&&"emacs"!==opts.keyMap&&(opts.extraKeys["Ctrl-Space"]=function(cm){
that._showAutoCompleteLoadingMsg(cm),that._enableIntellisenseFunc(cm)}),opts.readOnly=readOnly,CodeMirror.fromTextArea(t,opts)},_initLanguageSelecter:function(){var sel;return sel=$(this.element).find("#select-lang"),sel.select2({width:"off",data:_.map(_.sortBy(this.options.languages,function(l){return l}),function(_this){return function(l){return{id:l,text:_this.options.lang_display_mapping[l]}}}(this))}),sel.select2("val",this.state.language),1===this.options.languages.length&&"text"===this.options.languages[0]?sel.parent().addClass("hidden"):void 0},_changeLanguage:function(e){return this.changeLanguage($(e.currentTarget).select2("val")),this.triggerAnalyticsEvent("change","CodeShellChangeLanguage",$(e.currentTarget).select2("val"))},changeLanguage:function(lang,cb){return null==cb&&(cb=null),lang?(this.newLanguage=lang,this.options.dynamicMode?(this._showLoading(),this._trigger("loadmode",{},{lang:lang,callback:function(_this){return function(){return _this._changeMode(cb)}}(this)})):this._changeMode(cb)):void 0},_showLoading:function(msg){return null==msg&&(msg="Loading Editor... "),$(this.element).find(".code-body, .code-head, .code-tail").hide(),$(this.element).find(".loading-mode").html(msg).show()},_hideLoading:function(){return $(this.element).find(".code-body, .code-head, .code-tail").show(),$(this.element).find(".loading-mode").hide()},_changeMode:function(cb){var from,lang,sel,_ref,_ref1,_ref2,_ref3,_ref4;return null==cb&&(cb=null),this._hideLoading(),lang=this.newLanguage,from=this.state.language,this.options.language=this.state.language=lang,this.changeFirePadMode(lang),(!(null!=(_ref=this.options.firepad)?_ref.enabled:void 0)||null!=lang&&null!=from&&lang!==from)&&(this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(lang))),this._foldCode(),this.options.showNonEditableHeadTail&&this._displayHeadAndTail(lang),this._saveUserOpts({userPreferredLang:lang}),this.codeEditor.setOption("mode",this.options.lang_mime_mapping[lang]),this._setMainEditorLineNumber(lang),sel=$(this.element).find("#select-lang"),sel.select2("val",lang),this.codeEditor.clearHistory(),null!=this.firepad&&(null!=(_ref1=this.firepad.client_)&&null!=(_ref2=_ref1.undoManager)&&(_ref2.undoStack=[]),null!=(_ref3=this.firepad.client_)&&null!=(_ref4=_ref3.undoManager)&&(_ref4.redoStack=[])),this._trigger("languagechange",{},{from:from,to:lang}),"function"==typeof cb?cb():void 0},_saveCode:function(e){return e.preventDefault(),this.options.onSave?this.options.onSave():void 0},_initAutoSave:function(){var callback,timeout;return this.options.autoSave&&this.options.onSave?(timeout=parseInt(this.options.autoSave,10),callback=this.options.onSave,this._autoSaveCode(timeout,callback)):void 0},_autoSaveCode:function(timeout,callback){return callback(),setInterval(this._autoSaveCode,timeout,timeout,callback)},_setEditorMode:function(e){var mode,that;return mode=$(e.currentTarget).attr("data-editor"),$(e.currentTarget).parent().find(".editor-mode-button").removeClass("btn-primary"),$(e.currentTarget).addClass("btn-primary"),this.codeEditor.setOption("keyMap",mode),that=this,"emacs"===mode?delete this.codeEditor.options.extraKeys["Ctrl-Space"]:this.codeEditor.options.extraKeys["Ctrl-Space"]=function(cm){that._showAutoCompleteLoadingMsg(cm),that._enableIntellisenseFunc(cm)},this.focusEditor(e),this._saveUserOpts({keyMap:mode})},focusEditor:function(e){return this.codeEditor.focus()},_selectTemplateValue:function(){return _.first(_.filter(arguments,function(argument){return void 0!==argument&&argument!==!1}))},_getDefaultLangCode:function(l){var body,head,tail,_stripTabs,_suffix_new_line;if(this.options.forumMkdTool)return"";if(this.options.showTemplate&&!this.options.showNonEditableHeadTail){if(void 0!==this.options.lang_head_template[l]||void 0!==this.options.lang_template[l]||void 0!==this.options.lang_tail_template[l])return _stripTabs=function(string){var spaces,tab;return spaces=new Array(4).join(" "),tab="	",void 0===string?"":string.split(tab).join(spaces)},_suffix_new_line=function(string){return string&&-1===string.indexOf("\n",string.length-1)?""+string+"\n":string},head=_suffix_new_line(_stripTabs(this._selectTemplateValue(this.options.lang_head_template[l],""))),body=_suffix_new_line(_stripTabs(this._selectTemplateValue(this.options.lang_template[l],""))),tail=_suffix_new_line(_stripTabs(this._selectTemplateValue(this.options.lang_tail_template[l],""))),""+head+body+tail;if(this._selectTemplateValue(this.options.lang_template[l],this.options.lang_default_text[l]))return this._selectTemplateValue(this.options.lang_template[l],this.options.lang_default_text[l])}else if(this._selectTemplateValue(this.options.lang_template[l],this.options.lang_default_text[l]))return this._selectTemplateValue(this.options.lang_template[l],this.options.lang_default_text[l]);return""},_getLangCode:function(l){var val;return"before_create"===this.state._&&this.options.initialCode&&this.options.initialLanguage===l?this.options.initialCode:this.options.autoSaveNamespace&&(val=$.jStorage.get(this.getCurrentAutosavekey(l)),val&&!$.jStorage.get(""+this.getCurrentAutosavekey(l)+"-default_template"))?val:"after_create"===this.state._&&this.options.initialCode&&this.options.initialLanguage===l?this.options.initialCode:this._getDefaultLangCode(l)},_updateLangCode:function(that,cm){return that.options.lang_template[that.state.language]=cm.getValue()},_getLangHeadCode:function(l){return this.options.lang_head_template[l]?this.options.lang_head_template[l]:""},_updateLangHeadCode:function(that,cm){return that.options.lang_head_template[that.state.language]=cm.getValue()},_getLangTailCode:function(l){return this.options.lang_tail_template[l]?this.options.lang_tail_template[l]:""},_updateLangTailCode:function(that,cm){return that.options.lang_tail_template[that.state.language]=cm.getValue()},_displayHeadAndTail:function(l){var e,head_editor_lines,head_height;return e=$(this.element),this.options.adminView||0!==this._getLangHeadCode(l).length?(this.codeEditorHead.setValue(this._getLangHeadCode(l)),head_editor_lines=this.codeEditorHead.getValue().split("\n").length,this.codeEditor.setOption("firstLineNumber",head_editor_lines+1),this.codeEditorHead.setOption("mode",this.options.lang_mime_mapping[l]),this.codeEditorHead.foldCode(CodeMirror.Pos(0,0))):e.find(".code-head").hide(),this.options.adminView||0!==this._getLangTailCode(l).length?(this.codeEditorTail.setValue(this._getLangTailCode(l)),this._updateTailEditorLineNumber(),this.codeEditorTail.setOption("mode",this.options.lang_mime_mapping[l]),this.codeEditorTail.foldCode(CodeMirror.Pos(0,0))):e.find(".code-tail").hide(),head_height=e.find(".code-head").height(),e.find(".code-editors").scrollTop(head_height-60)},_updateTailEditorLineNumber:function(updateMain){var head_editor_lines,main_editor_lines;return null==updateMain&&(updateMain=!1),head_editor_lines=this.codeEditorHead.getValue().split("\n").length,main_editor_lines=this.codeEditor.getValue().split("\n").length,updateMain&&this.codeEditor.setOption("firstLineNumber",head_editor_lines+1),this.codeEditorTail.setOption("firstLineNumber",head_editor_lines+main_editor_lines+1)},_setMainEditorLineNumber:function(l){var head_editor_lines;return head_editor_lines=0,this.options.adminView&&this.options.showNonEditableHeadTail?head_editor_lines=this.codeEditorHead.getValue().split("\n").length:this._getLangHeadCode(l).length>0&&(head_editor_lines=this._getLangHeadCode(l).split("\n").length),this.options.lang_head_offset&&this.options.lang_head_offset[l]&&(head_editor_lines+=this.options.lang_head_offset[l]),this.codeEditor.setOption("firstLineNumber",head_editor_lines+1)},_growEditor:function(){var main_editor_height;return main_editor_height=this.element.find(".code-body").height(),300>main_editor_height&&(main_editor_height=300),this.element.find(".code-editors").css("max-height",""+(main_editor_height+110)+"px")},_saveLangCode:function(){var d,saveObject,that;return void 0===this.ActiveVersionId||null===this.ActiveVersionId?(d=new Date,saveObject=""+this.state.language+d.getHours()+d.getMinutes(),window[saveObject]&&clearTimeout(window[saveObject]),that=this,window[saveObject]=setTimeout(function(){return that.saveLangCode()},3e3)):void 0},saveLangCode:function(){var code,e,key,opts;if((void 0===this.ActiveVersionId||null===this.ActiveVersionId)&&(opts=this.options,opts.autoSaveNamespace)){key=this.getCurrentAutosavekey(),code=this.codeEditor.getValue();try{return $.jStorage.set(""+key+"-default_template",this._getDefaultLangCode(this.state.language)===code||this.options.lang_default_text[this.state.language]===code),$.jStorage.set(key,code)}catch(_error){return e=_error,this.setNotificationMessage('<div class="pjL pmA"> <i class="icon--single icon-attention msR"/>Issue saving to browser cache: another browser or computer may fix this.</div>'),console.log("Looks like an issue with saving to localstorage.")}}},getCurrentAutosavekey:function(l){var opts;return null==l&&(l=null),opts=this.options,null===l&&(l=this.state.language),opts.autoSaveNamespace&&this.state.language?""+opts.autoSaveNamespace+"-"+l:""},_getUserOpts:function(){var a,forced_opts;return a={lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,autoCloseTags:!0,indentWithTabs:!1,matchBrackets:!0,keyMap:"default",userPreferredLang:null,indentUnit:4},forced_opts={extraKeys:{Tab:function(cm){var characterAt,offset,spaces;return cm.somethingSelected()?cm.indentSelection("add"):(characterAt=cm.coordsChar(cm.cursorCoords()).ch,offset=characterAt%cm.getOption("indentUnit"),spaces=Array(cm.getOption("indentUnit")+1-offset).join(" "),cm.replaceSelection(spaces,"end","+input"))}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"]},$.extend($.extend(a,$.parseJSON($.jStorage.get("codeshellUserOpts"))),forced_opts),this.options.showMode===!1&&(a.keyMap="default"),a},_saveUserOpts:function(opts){var a,e;a=$.extend(this._getUserOpts(),opts);try{return $.jStorage.set("codeshellUserOpts",JSON.stringify(a))}catch(_error){return e=_error,console.log("Error with saving to localstorage")}},value:function(getall,callback){var allCode;return null==getall&&(getall=!1),null==callback&&(callback=null),getall?this.options.showFileTree?(this._checkAndSave(null,null,this,callback),{}):(allCode=[],_.each(this.options.languages,function(_this){return function(lang){return lang===_this.state.language?allCode.push(_this.value()):allCode.push({code:_this._getLangCode(lang),language:lang})}}(this)),allCode):{code:this.codeEditor.getValue(),language:this.state.language}},_foldCode:function(){var added_head,added_tail,clbk_head,clbk_tail,code,line,line_ctr,lines,_i,_len,_results;if(this.options.foldCode){for(code=this.codeEditor.getValue(),line_ctr=0,added_head=!1,added_tail=!1,lines=(code||"").split("\n"),_results=[],_i=0,_len=lines.length;_len>_i;_i++)line=lines[_i],line_ctr+=1,added_head||added_tail||-1===line.indexOf("Head ends")||(clbk_head=function(){return{from:{ch:0,line:0},to:{ch:0,line:line_ctr}}},CodeMirror.newFoldFunction(clbk_head)(this.codeEditor,{}),added_head=!0),added_tail||-1===line.indexOf("Tail starts")?_results.push(void 0):(clbk_tail=function(){return{from:{ch:0,line:line_ctr-1},to:{ch:0,line:lines.length}}},CodeMirror.newFoldFunction(clbk_tail)(this.codeEditor,{}),_results.push(added_tail=!0));return _results}},setValue:function(content,options){return null==options&&(options={}),content.language?this.changeLanguage(content.language,function(_this){return function(){return content.code?(_this.codeEditor.setValue(content.code),options.clearHistory&&_this.codeEditor.clearHistory(),_this._foldCode()):void 0}}(this)):void 0},setValueorFork:function(opts){var that;return that=this,opts.language&&window.HR.forkable===!0?this.changeLanguage(opts.language,function(){var _ref;return opts.code?($.jStorage.get(""+that.getCurrentAutosavekey(opts.language))&&(_ref=that.value().code)!==opts.code&&""!==_ref&&_ref!==that._getDefaultLangCode(opts.language)&&_ref!==that.options.lang_default_text[opts.language]&&window.HR.forkable===!0&&(window.HR.forkable=!1,that._forkNewBuffer(opts)),that.setValue(opts),that._foldCode()):void 0}):void 0},refresh:function(){return setTimeout(function(_this){return function(){return _this.codeEditor.refresh()}}(this),25),this.options.showNonEditableHeadTail?(setTimeout(function(_this){return function(){return _this.codeEditorHead.refresh()}}(this),25),setTimeout(function(_this){return function(){return _this.codeEditorTail.refresh()}}(this),25)):void 0},onChange:function(callback){return null!==callback?(this.codeEditor.on("change",callback),this.options.adminView&&this.options.showNonEditableHeadTail?(this.codeEditorHead.on("change",callback),this.codeEditorTail.on("change",callback)):void 0):void 0},setOption:function(key,value){return this.codeEditor.setOption(key,value)},getOptions:function(){return this.options},setStatusText:function(t){return null==t&&(t=""),this.options.statusText=t,$(this.element).find("#status-text").html(_.escape(t))},deleteLangCode:function(){var key,opts;return opts=this.options,opts.autoSaveNamespace?(key=""+opts.autoSaveNamespace+"-"+this.state.language,$.jStorage.deleteKey(key)):void 0},enableCompileBtn:function(){var $btn;return $btn=$(this.element).find("button.bb-compile"),$btn.removeAttr("btn-disabled").removeClass("disabled")},getEditor:function(){return this.codeEditor},setNotificationMessage:function(msg){var notify_msg_elem;return notify_msg_elem=$(this.element).find("#notification-message"),notify_msg_elem.html(msg),notify_msg_elem.removeClass("hidden")},hideNotification:function(){return $(this.element).find("#notification-message").addClass("hidden")},updateCodeshellOption:function(key,value){var lang,sel;if(this.options.adminView)return this._setOption(key,value),"languages"===key?(sel=$(this.element).find("#select-lang"),lang=sel.select2("val"),__indexOf.call(this.options.languages,lang)<0&&(lang=_.first(this.options.languages)),this._initLanguageSelecter(),this.changeLanguage(lang)):void 0},setTypingEvent:function(){return window.typingTrackCodeLength||(window.typingTrackCodeLength=0),window.typingTrackCodeLength=window.typingTrackCodeLength+1,window.typingEventEnabled=!0,window.triggerTypingEvent||(window.triggerTypingEvent=function(){var length;return window.typingEventEnabled=!1,$?(length=0,window.typingTrackCodeLength&&(length=window.typingTrackCodeLength),$.event.trigger({type:"AnalyticsEvent",event_type:"TypingEvent",event_name:"CodeShell",event_value:length}),window.typingTrackCodeLength=0):void 0}),window.typingTimeout&&window.clearTimeout(window.typingTimeout),window.typingTimeout=window.setTimeout(function(_this){return function(){return window.triggerTypingEvent()}}(this),1e3*this.options.typingTimespan)},triggerAnalyticsEvent:function(event_type,event_name,event_attribute){return null==event_type&&(event_type=null),null==event_name&&(event_name=null),null==event_attribute&&(event_attribute=null),event_type&&event_name?$.event.trigger({type:"AnalyticsEvent",event_type:event_type,event_name:event_name,event_value:event_attribute}):void 0},_totalCharactersTyped:0,destroy:function(){return this._saveLangCode(this),$.Widget.prototype.destroy.call(this)}})})}).call(this);